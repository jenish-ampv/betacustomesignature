%%DEFINE_HEADER%%

<div class="flex flex-col md:flex-row w-full">
	<div class="flex gap-3 w-full md:w-6/12 xl:w-7/12  flex-col p-8 lg:p-10">
		<div>
			<a href="%%DEFINE_ROOT_LINK%%/signin" class="kt-btn kt-btn-ghost inline-flex items-center gap-2">
				<i class="fal fa-angle-left text-xl mt-0.5"></i> <span>Back</span>
			</a>
		</div>
		<div class="flex-1 flex items-center justify-center xl:px-7">
			<div class="max-w-[460px] w-full mx-auto">
				<div class="text-center mb-4">
					<img class="inline-flex" src="%%DEFINE_IMAGE_LINK%%/images/logoThumb.svg" alt="">
				</div>
				%%DEFINE_Message%%
				
				IF("%%DEFINE_ve_step%%" == "1"){
				<h5 class="text-2xl text-center font-normal w-full">Create your Account</h5>
				<form name="resetpassword" id="verify_email_form" method="post" class="kt-card p-8 mt-10 [box-shadow:0_4px_24px_rgba(29,74,254,0.3)]">
					<div class="flex flex-col gap-6">
						<div>
							<div>
								<label class="kt-form-label">Business email</label>
								<div class="kt-form-control">
									<input type="email" class="kt-input" id="ve_email" name="ve_email"
										id="ve_email" placeholder="Business email" required="required">
								</div>
							</div>
							<div class="my-3">
								<label class="kt-form-label">Password</label>
								<div class="kt-form-control">
									<input type="password" class="kt-input" name="ve_password" id="ve_password"
									placeholder="Password" required="required">
								</div>
							</div>
						</div>
						<div>
							<div class="text-center relative">
								<span class="border-t border-gray-300 absolute w-full top-1/2 left-0"></span>
								<span class="bg-white px-3 relative z-1 text-gray-500">Or continue with email</span>
							</div>
							<div class="grid grid-cols-3 gap-2 mt-4">
								<a href="%%DEFINE_GOOGLE_LOGIN_AUTHURL%%">
								<img src="%%DEFINE_IMAGE_LINK%%/images/button-google.svg" alt="">
								</a>
								<a href="%%DEFINE_FACEBOOK_SIGNIN_AUTHURL%%">
								<img src="%%DEFINE_IMAGE_LINK%%/images/button-facebook.svg" alt="">
								</a>
								<a href="%%DEFINE_X_SIGNIN_AUTHURL%%">
								<img src="%%DEFINE_IMAGE_LINK%%/images/button-twitter.svg" alt="">
								</a>
							</div>
						</div>
						<div>
							<button type="submit" name="signin" class="kt-btn kt-btn-primary w-full" id="verify_email_submit_button">Continue</button>
						</div>
						<div class="text-center text-gray-400 text-sm font-light">
							Already have an account? <a class="text-primary font-semibold" href="%%DEFINE_moduleLinkLogin%%">Log in</a>
						</div>
					</div>
				</form>
				{:IF}

				IF("%%DEFINE_ve_step%%" == "2"){
				<form name="resetpassword" method="post">
					<h5 class="text-2xl text-center font-normal w-full">Verify OTP</h5>
					<p class="text-center">Please enter the 6-digit code sent to you at<br><a href="mailto:%%DEFINE_otp_email%%" class="text-primary">%%DEFINE_otp_email%%</a></p>
					<p class="text-center mt-1 text-gray-400">check spam folder if not in inbox</p>
					<div class="kt-card p-8 mt-10 [box-shadow:0_4px_24px_rgba(29,74,254,0.3)]">
						<span id="verify_email_otp_error_message"></span>
						<div class="digit-group flex justify-center gap-2 *:size-[52px] *:text-center">
							<input type="text" id="digit-1" name="digit-1" data-next="digit-2"
								class="inputotp kt-input !rounded-lg !size-[52px] focus-within:bg-primary/10 focus-within:border-primary" />
							<input type="text" id="digit-2" name="digit-2" data-next="digit-3"
								data-previous="digit-1" class="inputotp kt-input !rounded-lg !size-[52px] focus-within:bg-primary/10 focus-within:border-primary" />
							<input type="text" id="digit-3" name="digit-3" data-next="digit-4"
								data-previous="digit-2" class="inputotp kt-input !rounded-lg !size-[52px] focus-within:bg-primary/10 focus-within:border-primary" />
							<input type="text" id="digit-4" name="digit-4" data-next="digit-5"
								data-previous="digit-3" class="inputotp kt-input !rounded-lg !size-[52px] focus-within:bg-primary/10 focus-within:border-primary" />
							<input type="text" id="digit-5" name="digit-5" data-next="digit-6"
								data-previous="digit-4" class="inputotp kt-input !rounded-lg !size-[52px] focus-within:bg-primary/10 focus-within:border-primary" />
							<input type="text" id="digit-6" name="digit-6" data-previous="digit-5"
								class="inputotp kt-input !rounded-lg !size-[52px] focus-within:bg-primary/10 focus-within:border-primary" />
						</div>
						<button type="submit" name="submit" class="my-5 kt-btn kt-btn-primary w-full" id="verifyOTP">Continue</button>
						<div class="text-center text-gray-400 text-sm font-light">
							Didn’t receive OTP code? <a href="%%DEFINE_li_resendotp%%" class="text-primary font-semibold">Resend Code</a>
						</div>
					</div>
				</form>
				{:IF}
			</div>
		</div>
		<div class="flex flex-col gap-4 mt-4 text-sm items-center justify-between xl:flex-row">
			<span class="text-gray-600">© 2025 Custom Esignature's Inc. All rights reserved.</span>
			<div class="flex text-gray-700 items-center gap-2">
				<a href="https://www.customesignature.com/privacypolicy" target="_blank">Privacy Policy</a>
				<i class="fas fa-circle text-[6px] text-gray-400"></i>
				<a href="https://www.customesignature.com/terms-of-use" target="_blank">Terms and Conditions</a>
			</div>
		</div>
	</div>
	<div class="flex flex-col w-full py-8 px-3 md:w-6/12 xl:w-5/12 bg-gray-100 bg-top xxl:bg-center xl:bg-cover bg-no-repeat"
		style="background-image: url(%%DEFINE_IMAGE_LINK%%/images/loginbg.jpg);">
		<div class="w-full flex-1 flex flex-col justify-center">
			<h3 class=" px-5 xl:px-16  leading-[1.2] mb-4">
				<span class="bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent">ExceptionalService</span>
				That Exceeds Expectations</h3>
			<div class="swiper w-full" id="loginSlider">
				<div class="swiper-wrapper">
					<div class="swiper-slide px-5 xl:px-16">
						<p class="text-gray-700 relative pt-4"><i
								class="fas fa-quote-left absolute text-gray-900 top-3 -left-4 text-xl"></i> I had a
							fantastic
							experience
							with this service! The team was super helpful and really focused on my satisfaction. They
							listened to my
							needs and went above and beyond.</p>
						<div class="flex items-center gap-2 mt-6">
							<img class="rounded-full" src="%%DEFINE_IMAGE_LINK%%/images/user.jpg" alt="">
							<div>
								<p class="text-sm">Sage Miller</p>
								<p class="text-xs text-gray-500">Founder - Awaken</p>
							</div>
						</div>
					</div>
					<div class="swiper-slide px-5 xl:px-16">
						<p class="text-gray-700 relative pt-4"><i
								class="fas fa-quote-left absolute text-gray-900 top-3 -left-4 text-xl"></i> I had a
							fantastic
							experience
							with this service! The team was super helpful and really focused on my satisfaction. They
							listened to my
							needs and went above and beyond.</p>
						<div class="flex items-center gap-2 mt-6">
							<img class="rounded-full" src="%%DEFINE_IMAGE_LINK%%/images/user.jpg" alt="">
							<div>
								<p class="text-sm">Sage Miller</p>
								<p class="text-xs text-gray-500">Founder - Awaken</p>
							</div>
						</div>
					</div>
					<div class="swiper-slide px-5 xl:px-16">
						<p class="text-gray-700 relative pt-4"><i
								class="fas fa-quote-left absolute text-gray-900 top-3 -left-4 text-xl"></i> I had a
							fantastic
							experience
							with this service! The team was super helpful and really focused on my satisfaction. They
							listened to my
							needs and went above and beyond.</p>
						<div class="flex items-center gap-2 mt-6">
							<img class="rounded-full" src="%%DEFINE_IMAGE_LINK%%/images/user.jpg" alt="">
							<div>
								<p class="text-sm">Sage Miller</p>
								<p class="text-xs text-gray-500">Founder - Awaken</p>
							</div>
						</div>
					</div>
					<div class="swiper-slide px-5 xl:px-16">
						<p class="text-gray-700 relative pt-4"><i
								class="fas fa-quote-left absolute text-gray-900 top-3 -left-4 text-xl"></i> I had a
							fantastic
							experience
							with this service! The team was super helpful and really focused on my satisfaction. They
							listened to my
							needs and went above and beyond.</p>
						<div class="flex items-center gap-2 mt-6">
							<img class="rounded-full" src="%%DEFINE_IMAGE_LINK%%/images/user.jpg" alt="">
							<div>
								<p class="text-sm">Sage Miller</p>
								<p class="text-xs text-gray-500">Founder - Awaken</p>
							</div>
						</div>
					</div>
				</div>
				<div class="swiper-pagination mt-8 !static px-5 xl:px-16 text-center xl:!text-left md:!text-left"></div>
			</div>
		</div>
		<div class="px-5 xl:px-16 mb-0 xl:mb-12 md:mb-8 mt-5">
			<p class="text-black text-sm mb-4">Trusted by Industry Leading Companies</p>
			<div class="flex flex-wrap items-center *:px-4 *:py-3">
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l1.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l2.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l3.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l4.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l5.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l6.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l7.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l8.png"></div>
				<div><img src="%%DEFINE_IMAGE_LINK%%/images/l9.png"></div>
			</div>
		</div>
	</div>
</div>

<script src="%%DEFINE_ROOT_LINK%%/script/jquery-3.5.1.min.js"></script>
<script>
$(document).ready(function(){
	if($('.alert').length > 0){
		setTimeout(function(){ $('.alert').hide(); }, 3000);
	}
	// Function to check if all OTP fields are filled
	function checkOtpFields() {
		let allFilled = true;
		for (let i = 1; i <= 6; i++) {
			if (!$(`#digit-${i}`).val()) {
				allFilled = false;
				break;
			}
		}
		$('#verifyOTP').prop('disabled', !allFilled);
	}

	// Handle input for each OTP field
	$('.inputotp').on('input', function(e) {
		// Get the current input value
		let value = $(this).val().trim();

		// Error message on non-digit characters
		if (value && !/^\d+$/.test(value)) {
			e.preventDefault();
			$('#verify_email_otp_error_message').html('<div class="alert alert-danger"><strong>Fail!</strong> Please enter numbers only.</div>');
			setTimeout(function(){ $('#verify_email_otp_error_message').html(''); }, 3000);
			$(this).val('');
			return;
		}

		// Take only the first digit
		value = value.slice(0, 1);

		// Update the input value
		$(this).val(value);

		// Check if all fields are filled
		checkOtpFields();

		// If a digit was entered, move to next input
		if (value.length === 1) {
			let nextInput = $(this).next('.inputotp');
			if (nextInput.length) {
				nextInput.focus();
			}
 
            // Take only the first digit
            value = value.slice(0, 1);
 
            // Update the input value
            $(this).val(value);
 
            // Check if all fields are filled
            checkOtpFields();
 
            // If a digit was entered, move to next input
            if (value.length === 1) {
                let nextInput = $(this).next('.inputotp');
                if (nextInput.length) {
                    nextInput.focus();
                }
            }
        };
 
        // Handle backspace key
        $('.inputotp').on('keydown', function(e) {
            if (e.key === 'Backspace' && !$(this).val()) {
                let prevInput = $(this).prev('.inputotp');
                if (prevInput.length) {
                    prevInput.focus();
                }
            }
        });
 
        // Handle paste event
        $('.inputotp').on('paste', function(e) {
            e.preventDefault();
            let pastedData = (e.originalEvent.clipboardData || window.clipboardData).getData('text').trim();
			if (!/^\d+$/.test(pastedData)) {
				$('#verify_email_otp_error_message').html('<div class="alert alert-danger"><strong>Fail!</strong> Please enter numbers only.</div>');
				setTimeout(function(){ $('#verify_email_otp_error_message').html(''); }, 3000);
				return;
			}
            pastedData = pastedData.replace(/[^0-9]/g, '').slice(0, 6);
 
            // Fill the inputs with pasted data
            for (let i = 0; i < pastedData.length; i++) {
                $(`#digit-${i + 1}`).val(pastedData[i]);
            }
 
            // Check if all fields are filled
            checkOtpFields();
 
            // Focus the next empty input or the last input
            let nextEmptyInput = $('.inputotp').filter(function() {
                return !$(this).val();
            }).first();
 
            if (nextEmptyInput.length) {
                nextEmptyInput.focus();
            } else {
                $('#digit-6').focus();
            }
        });


		function showError(input, message) {
			isValidFirstStep = false;
			let $input = $(input);

			// Check if input is inside .fw-row
			let $fwRow = $input.closest('.fv-row');

			// If parent .fw-row exists, insert error inside it
			if ($fwRow.length) {
				let $existingError = $fwRow.children('.error-msg').last();

				if ($existingError.length) {
					// Update existing error
					$existingError.text(message);
				} else {
					// Add new error at the end of .fw-row
					let $errorMsg = $('<div class="error-msg text-xs text-danger"></div>').text(message);
					$fwRow.append($errorMsg);
				}

			} else {
				// Default: error message after input
				let $existingError = $input.nextAll('.error-msg').first();

				if ($existingError.length) {
					$existingError.text(message);
				} else {
					let $lastDiv = $input.nextAll('div').last();
					let $errorMsg = $('<div class="error-msg text-xs text-danger"></div>').text(message);

					if ($lastDiv.length > 0) {
						$lastDiv.after($errorMsg);
					} else {
						$input.after($errorMsg);
					}
				}
			}
		}

		function removeError(input) {
			let $input = $(input);

			// Remove the first error message found after the input
			let $existingError = $input.nextAll('.error-msg').first();
			if ($existingError.length) {
				$existingError.remove();
			}
		}

		$("#verify_email_submit_button").on("click", function (e){
			e.preventDefault();

			// Validate company name
			let companyName = $('#ve_email').val().trim();
			if (companyName === '') {
				showError('#ve_email', 'Email is required.');
			} else{
				removeError('#ve_email');
			}

			// Validate password
			var password = $('#ve_password').val();
			var errorMessage = '';

			if (password.length < 8) {
				showError('#ve_password', 'Password must be at least 8 characters long.');
			}
			else if (!/[a-z]/.test(password)) {
				showError('#ve_password', 'Password must contain at least one lowercase letter.');
			}
			else if (!/[A-Z]/.test(password)) {
				showError('#ve_password', 'Password must contain at least one uppercase letter.');
			}
			else if (!/[0-9]/.test(password)) {
				showError('#ve_password', 'Password must contain at least one number.');
			}
			else if (!/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
				showError('#ve_password', 'Password must contain at least one special character.');
			}
			else{
				removeError('#ve_password');
				$('#verify_email_form').submit();
			}

		});

	});

	// Handle backspace key
	$('.inputotp').on('keydown', function(e) {
		if (e.key === 'Backspace' && !$(this).val()) {
			let prevInput = $(this).prev('.inputotp');
			if (prevInput.length) {
				prevInput.focus();
			}
		}
	});

	// Handle paste event
	$('.inputotp').on('paste', function(e) {
		e.preventDefault();
		let pastedData = (e.originalEvent.clipboardData || window.clipboardData).getData('text').trim();
		if (!/^\d+$/.test(pastedData)) {
			$('#verify_email_otp_error_message').html('<div class="alert alert-danger"><strong>Fail!</strong> Please enter numbers only.</div>');
			setTimeout(function(){ $('#verify_email_otp_error_message').html(''); }, 3000);
			return;
		}
		pastedData = pastedData.replace(/[^0-9]/g, '').slice(0, 6);

		// Fill the inputs with pasted data
		for (let i = 0; i < pastedData.length; i++) {
			$(`#digit-${i + 1}`).val(pastedData[i]);
		}

		// Check if all fields are filled
		checkOtpFields();

		// Focus the next empty input or the last input
		let nextEmptyInput = $('.inputotp').filter(function() {
			return !$(this).val();
		}).first();

		if (nextEmptyInput.length) {
			nextEmptyInput.focus();
		} else {
			$('#digit-6').focus();
		}
	});
});
</script>

%%DEFINE_FOOTER%%