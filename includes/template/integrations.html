%%DEFINE_HEADER%%
<div class="flex grow flex-col in-data-kt-[sticky-header=on]:pt-(--header-height-default) overflow-auto">
    %%DEFINE_SIDEBAR%%
    <main class="grow" id="content" role="content">
		<div class="kt-container-fluid pb-4 h-full">
            <div id="snackbar" class="success-error-message fixed top-0 right-0 p-3"></div>
            <div id="snackbar-error" class="success-error-message fixed top-0 right-0 p-3"></div>
            <div id="snackbar-info" class="success-error-message fixed top-0 right-0 p-3"></div>
            IF("%%DEFINE_PageView%%" == "googleconnect"){
            <div class="w-full max-w-[700px] mx-auto h-full flex items-center justify-center">
                <div class="inline-flex flex-col gap-3">
                    <div class="%%DEFINE_Gstep1%%">
                        <div class="kt-card kt-card-accent step" id="step2">
                            <div class="kt-card-header">
                                <h2 class="kt-card-title">
                                    <img src="%%DEFINE_IMAGE_LINK%%/images/google-workspace-icon.svg" alt=""> Google Workspace Integration
                                </h2>
                            </div>
                            <div class="kt-card-content">
                                <div class="flex items-center gap-4">
                                    <div class="text-gray-950 flex items-center gap-3">
                                        <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-950 text-white">1</span>
                                        Step
                                    </div>
                                    <div class="text-gray-200 flex items-center gap-3">
                                        <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-200 text-white">2</span>
                                        Step
                                    </div>
                                </div>
                                <div class="headbox_content">
                                    <p class="mt-5 text-xl font-semibold">Are you a Google Workspace Admin?</p>
                                    <p class="mb-5">To complete a domain-wide integration, you must be a Google Workspace Admin. Please choose your role below so we can provide the correct step-by-step setup instructions.</p>

                                    <div class="flex gap-2">
                                        <a href="%%DEFINE_google_connect%%/2/0" class="kt-btn kt-btn-mono bg-gray-300 text-black">No, I don't</a>
                                        <a href="%%DEFINE_google_connect%%/2/1" class="kt-btn kt-btn-primary">Yes, I do</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="%%DEFINE_Gstep2%%">
                        <div class="kt-card kt-card-accent %%DEFINE_contentclsyes%%" id="step2">
                            <div class="kt-card-header">
                                <h2 class="kt-card-title">
                                    <img src="%%DEFINE_IMAGE_LINK%%/images/google-workspace-icon.svg" alt=""> Google Workspace Integration
                                </h2>
                            </div>
                            <div class="kt-card-content">
                                <div class="flex items-center gap-4 mb-5">
                                    <div class="text-gray-200 flex items-center gap-3">
                                        <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-200 text-white">1</span>
                                        Step
                                    </div>
                                    <div class="text-gray-950 flex items-center gap-3">
                                        <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-950 text-white">2</span>
                                        Step
                                    </div>
                                </div>
                                <p class="text-gray-950 font-semibold text-sm mb-2">Do you have a Google Workspace Admin role?</p>
                                <p>If yes, follow these steps to set up the integration:</p>
                                <p>1. Follow the integration instructions provided in this guide <a class="text-primary" target="_blank" href="%%DEFINE_IMAGE_LINK%%/images/Google_Workspace_Integration_Guide.pdf">here.</a></p>
                                <p>2. Enable or disable Automatic Signature Update with Google Directory as needed.</p>
                                <p>3. Once all settings are configured, click Start Connection.</p>
                                <div class="flex items-center gap-2 mt-5 mb-4">
                                    <label class="kt-label text-gray-950">Automatic Signature Update with Google Directory</label>
                                    <input class="kt-switch autoupdateswitch" type="checkbox" role="switch" id="signature_auto_update" name="signature_auto_update" value="1" checked="">
                                </div>
                                <p>CustomEsignature can automatically update employee signatures whenever information (e.g., name, title, phone number) changes in Google Directory.</p>
                                <p>
                                    1. Automatic sync occurs every 24 hours.<br/>
                                    2. You can also perform a manual signature update at any time.
                                </p>
                                <div class="flex gap-2 mt-3">
                                    <a href="%%DEFINE_google_connect%%" class="kt-btn kt-btn-mono">Previous Step</a>
                                    <a class="kt-btn kt-btn-primary" id="step1-btngl" href="javascript:void(0);">Start Connection</a>
                                </div>
                                <form id="gsuite">
                                    <input type="hidden" name="google_connect" value="1" />
                                    <span class="error hidden" id="admin"></span>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- content no -->
                    <div class="kt-card kt-card-accent %%DEFINE_contentclsno%%" id="step2">
                        <div class="kt-card-header">
                            <h2 class="kt-card-title">
                                <img src="%%DEFINE_IMAGE_LINK%%/images/google-workspace-icon.svg" alt=""> Google Workspace Integration
                            </h2>
                        </div>
                        <div class="kt-card-content">
                            <div class="flex items-center gap-4 mb-5">
                                <div class="text-gray-200 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-200 text-white">1</span>
                                    Step
                                </div>
                                <div class="text-gray-950 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-950 text-white">2</span>
                                    Step
                                </div>
                            </div>
                            <p>Invite your Google Workspace Admin to set up the connection.
                                The invite creates a platform user entry and triggers an email notification.
                                Your admin must accept and log in through their Google Admin account.
                            </p>
                            <form id="inviteadmin">
                                <div class="flex flex-col gap-3 my-5">
                                    <div>
                                        <label class="kt-form-label" for="admin_firstname">First Name</label>
                                        <input type="text" class="kt-input" id="admin_firstname" name="admin_firstname" placeholder="First Name" required="required" value="">
                                        <span class="error text-danger hidden" id="ai">First Name is required field</span>
                                    </div>
                                    <div>
                                        <label class="kt-form-label" for="admin_lastname">Last Name</label>
                                        <input type="text" class="kt-input" id="admin_lastname" name="admin_lastname" placeholder="Last Name" required="required" value="">
                                        <span class="error text-danger hidden" id="as">Last Name is required field</span>
                                    </div>
                                    <div>
                                        <label class="kt-form-label" for="admin_email">Email</label>
                                        <input type="text" class="kt-input" id="admin_email" name="admin_email" placeholder="Email" required="required" value="">
                                        <span class="error text-danger hidden" id="at">Email is required field</span>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <a href="%%DEFINE_google_connect%%" class="kt-btn kt-btn-mono">Previous Step</a>
                                    <a class="kt-btn kt-btn-primary" id="invite-btn" href="#">Invite Google Workspace Admin </a>
                                </div>
                                <input type="hidden" name="gsuite_inviteadmin" value="1" />
                            </form>
                        </div>
                    </div>

                    <div class="kt-card kt-card-accent %%DEFINE_Gstep3%%" id="step2" style="display: none;">
                        <div class="kt-card-header">
                            <h2 class="kt-card-title">
                                <img src="%%DEFINE_IMAGE_LINK%%/images/google-workspace-icon.svg" alt=""> Google Workspace Integration
                            </h2>
                        </div>
                        <div class="kt-card-content">
                            <div class="flex items-center gap-4 mb-5">
                                <div class="text-gray-200 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-200 text-white">1</span>
                                    Step
                                </div>
                                <div class="text-gray-200 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-200 text-white">2</span>
                                    Step
                                </div>
                                <div class="text-gray-950 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-950 text-white">3</span>
                                    Step
                                </div>
                            </div>
                            <p>Watch a quick video demo on how to automate email signatures management after<br /> the integration has been set.</p>
                            <img class="my-3" src="%%DEFINE_IMAGE_LINK%%/images/googleworkspace-demo.png" />
                            <a class="kt-btn kt-btn-primary" href="%%DEFINE_google_connect%%">Complete</a>
                        </div>
                    </div>
                </div>
            </div>
            {:IF}

            IF("%%DEFINE_PageView%%" == "msconnect"){
            <div class="w-full max-w-[700px] mx-auto h-full flex items-center justify-center">
                <div class="inline-flex flex-col gap-3">
                    <div class="kt-card kt-card-accent signature_integration_withhead_box step" id="msstep1">
                        <div class="kt-card-header p-0 sm:p-4">
                            <h2 class="kt-card-title flex p-0 items-center gap-4 sm:gap-1 p-2">
                                <img src="%%DEFINE_IMAGE_LINK%%/images/subtract-icon.svg" alt=""> Azure AD Application Credentials
                            </h2>
                        </div>
                        <div class="kt-card-content">
                            <div class="flex items-center gap-4 mb-5">
                                <div class="text-gray-950 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-950 text-white">1</span>
                                    Step
                                </div>
                                <div class="text-gray-200 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-200 text-white">2</span>
                                    Step
                                </div>
                            </div>
                            <p>Please, provide the following information after you have set the AD application:</p>
                            <form id="msazur">
                                <div class="flex flex-col gap-3 my-5">
                                    <div>
                                        <label class="kt-form-label" for="">Application ID</label>
                                        <input type="text" class="kt-input" id="application_id" name="application_id" placeholder="Application ID" required="required" value="">
                                        <span class="error text-danger hidden" id="ai">Application ID is required field</span>
                                    </div>
                                    <div>
                                        <label class="kt-form-label" for="">Application Secret</label>
                                        <input type="text" class="kt-input" id="application_secret" name="application_secret" placeholder="Application Secret" required="required" value="">
                                        <span class="error text-danger hidden" id="as">Application Secret is required field</span>
                                    </div>
                                    <div>
                                        <label class="kt-form-label" for="">Application Tenant ID</label>
                                        <input type="text" class="kt-input" id="application_tenant" name="application_tenant" placeholder="Application Tenant ID" required="required" value="">
                                        <span class="error text-danger hidden" id="at">Application Tenant ID is required field</span>
                                    </div>
                                    <div class="style_design_box" style="display:none;">
                                        <label class="kt-form-label">Automatic Signature Update with Active Directory</label>
                                        <input class="kt-switch autoupdateswitch" type="checkbox" role="switch" id="signature_auto_update" name="signature_auto_update" value="1" checked>
                                    </div>
                                </div>
                                <p>Custom Esignature can automatically update signatures if any information imported to the signature is changed in Outlook Directory. Automatic sync will occur every 24 hours. Manual signature updates can still be done at any point of time.</p>
                                <div class="mt-3 text-right">
                                    <a class="kt-btn kt-btn-primary" id="step1-btn" href="#">Continue </a>
                                </div>
                                <input type="hidden" name="azuread_connect" value="1" />
                            </form>
                        </div>
                    </div>
                    <div class="kt-card kt-card-accent signature_integration_withhead_box step" id="msstep2" style="display:none;">
                        <div class="kt-card-header">
                            <h2 class="kt-card-title flex gap-2 items-center">
                                <img src="%%DEFINE_IMAGE_LINK%%/images/subtract-icon.svg" alt=""> Microsoft 365 Demo
                            </h2>
                        </div>
                        <div class="kt-card-content">
                            <div class="flex items-center gap-4 mb-5">
                                <div class="text-gray-200 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-200 text-white">1</span>
                                    Step
                                </div>
                                <div class="text-gray-950 flex items-center gap-3">
                                    <span class="flex-none flex items-center justify-center rounded-lg size-8 bg-gray-950 text-white">2</span>
                                    Step
                                </div>
                            </div>

                            <p class="mb-2">Watch a quick video demo on how to automate email signatures management after the integration has been set.</p>
                            <p>Please note, that it may take some time before you are able to deploy signatures after the Add-in is installed.</p>
                            <p>&nbsp;</p>
                            <div class="bulkupload_video">
                                <img src="%%DEFINE_IMAGE_LINK%%/images/bulkupload_video.png" style="width:100%;" />
                            </div>
                            <div class="mt-5">
                                <a class="kt-btn kt-btn-primary" id="step1-btn" href="%%DEFINE_integrations%%">Complete </a>
                            </div>
                        </div>
                    </div>

                    <div class="kt-card kt-card-accent signature_integration_withhead_box">
                        <div class="kt-card-header">
                            <h2 class="kt-card-title">
                                Microsoft 365 Add-in instructions
                            </h2>
                        </div>
                        <div class="kt-card-content space-y-2">
                            <p>Custom Esignature integrates with your Microsoft 365 to help you automatically create and manage email signatures for the entire organization. Create and roll out branded email signatures with domain-wide Microsoft Add-in without having to neither set up email routing nor connect to a third-party server.</p>
                            <p>Custom Esignature connects to Microsoft 365 Active Directory with the help of Graph API which allows creating and updating email signatures based on the employee's information in Active Directory. The email signatures in Outlook are then managed by Microsoft Add-in that is centrally installed by the admin for the entire domain or specific group of employees.</p>
                            <p>The first step is to set up an integration with Microsoft 365 Active Directory. Please, follow the instructions below:</p>
                            <p><a class="text-primary" target="_blank" href="%%DEFINE_IMAGE_LINK%%/images/file/Steps-for-Azure-AD-portal.pdf">Instructions here</a></p>
                        </div>
                    </div>
                </div>
            </div>
            {:IF}
                
            IF("%%DEFINE_PageView%%" == "integrations"){
            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
                <div class="signature_integration_box kt-card kt-card-accent">
                    <div class="kt-card-content flex flex-col relative overflow-hidden">
                        <div class="dot_icon %%DEFINE_glconnectedbtncls%%" class="absolute top-3 right-3">
                            <a href="javascript:void(0);" class="absolute top-3 right-3" onclick="myFunction(1)">
                                <img  src="%%DEFINE_IMAGE_LINK%%/images/dot-icon.svg" alt="">
                            </a>
                        </div>
                        <div id="myDIV1" class="menu_open absolute inset-0 bg-white/90 z-[2]" style="display:none;">
                            <div class="close_icon"><a class="openPopupClass" href="javascript:void(0);" onclick="myFunction(1)">
                                <!-- <img class="openPopupClass" src="https://betaapp.customesignature.com/images/close-signature-icon.svg" alt=""> -->
                                 <i class="fal fa-times-circle cursor-pointer absolute top-2 right-2"></i>
                            </a></div>
                            <div class="flex flex-col gap-3 items-center justify-center h-full">
                                <ul class="flex gap-2">
                                    <li>
                                        <a data-kt-tooltip="true" data-kt-tooltip-placement="top" href="javascript:void(0);" class="kt-btn kt-btn-primary kt-btn-outline kt-btn-icon" title data-bs-original-title="Disconnect" data-kt-modal-toggle="#DisconnectModalGL" data-id="1">
                                             <i class="hgi hgi-stroke hgi-unlink-04"></i>
                                             <span data-kt-tooltip-content="true" class="kt-tooltip">Disconnect</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="flex items-center gap-3 text-lg font-semibold text-black">
                            <img class="h-9" src="%%DEFINE_IMAGE_LINK%%/images/g-suite.svg" alt="">
                            <span>Google Workspace</span>
                        </div>
                        <div class="flex-1 mb-5">
                            <p class="my-3 font-medium text-black text-xs">Seamlessly integrate your Google Workspace with Custom Esignature to effortlessly manage and deploy email signatures across your organization.</p>
                            <ul>
                                <li class="flex items-center gap-1"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent"></i> Sync with Google Contacts</li>
                                <li class="flex items-center gap-1"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent"></i> 2-way Sync from Custom Esignature to Gmail</li>
                                <li class="flex items-center gap-1"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent"></i> Easy Deployment</li>
                                <li class="flex items-center gap-1"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent"></i> OAuth2.0 Security</li>
                            </ul>
                        </div>
                        <div class="flex gap-3">
                            <a class="kt-btn kt-btn-primary flex-1 %%DEFINE_glconnectbtncls%%" href="%%DEFINE_google_connect%%">Connect</a>
                            <a class="kt-btn kt-btn-secondary flex-1 %%DEFINE_glconnectedbtncls%%" href="javascrip:void(0);" style="cursor:default;">Connected</a>
                        </div>
                    </div>
                </div>
                <div class="signature_integration_box kt-card kt-card-accent">
                    <div class="kt-card-content flex flex-col relative overflow-hidden">
                        <div class="dot_icon %%DEFINE_connectedbtncls%%"><a href="javascript:void(0);" class="absolute top-3 right-3" onclick="myFunction(2)"><img src="%%DEFINE_IMAGE_LINK%%/images/dot-icon.svg" alt=""></a></div>
                        <div id="myDIV2" class="menu_open absolute inset-0 bg-white/90 z-[2]" style="display:none;">
                            <div class="close_icon">
                                <a class="openPopupClass" href="javascript:void(0);" onclick="myFunction(2)">
                                    <!-- <img class="openPopupClass" src="https://betaapp.customesignature.com/images/close-signature-icon.svg" alt=""> -->
                                    <i class="fal fa-times-circle cursor-pointer absolute top-2 right-2"></i>
                                </a>
                            </div>
                            <div class="flex flex-col gap-3 items-center justify-center h-full">
                                <ul class="flex gap-2">
                                    <li>
                                        <a href="javascript:void(0);" class="kt-btn kt-btn-primary kt-btn-outline kt-btn-icon" data-kt-tooltip="true" data-kt-tooltip-placement="top" title data-bs-original-title="Disconnect" data-kt-modal-toggle="#DisconnectModalMS" data-id="0">
                                            <i class="hgi hgi-stroke hgi-unlink-04"></i>
                                            <span data-kt-tooltip-content="true" class="kt-tooltip">Disconnect</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);" class="kt-btn kt-btn-primary kt-btn-outline kt-btn-icon" id="forcetoupdate" data-kt-tooltip="true" data-kt-tooltip-placement="top" title data-bs-original-title="Force Update" data-url="%%DEFINE_azuread%%">
                                            <i class="hgi hgi-stroke hgi-exchange-01"></i>
                                            <span data-kt-tooltip-content="true" class="kt-tooltip">Force Update</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="%%DEFINE_integrations%%/installaddin" class="kt-btn kt-btn-primary kt-btn-outline kt-btn-icon" id="installaddin" data-kt-tooltip="true" data-kt-tooltip-placement="top" title data-bs-original-title="Install Add-in">
                                            <i class="hgi hgi-stroke hgi-view"></i>
                                            <span data-kt-tooltip-content="true" class="kt-tooltip">Install Add-in</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="flex items-center gap-3 text-lg font-semibold text-black">
                            <img class="h-9" src="%%DEFINE_IMAGE_LINK%%/images/ms-office.svg" alt="">
                            <span>Outlook</span>
                        </div>
                        <div class="flex-1 mb-5">
                            <p class="my-3 font-medium text-black text-xs">Outlook email communications with the added advantage of Custom Esignature. With direct integration, unify your signature experience.</p>
                            <ul class="*:flex *:items-center *:gap-1">
                                <li><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent"></i> 2-way Sync from Custom Esignature to Outlook</li>
                                <li><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent"></i> Template Assignment based on user roles or departments</li>
                                <li><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent"></i> Easy Deployment</li>
                            </ul>
                        </div>
                        <div class="flex gap-3">
                            <a class="kt-btn kt-btn-primary flex-1 %%DEFINE_connectbtncls%%" href="%%DEFINE_microsoft_connect%%">Connect</a>
                            <span class="kt-btn kt-btn-secondary flex-1 %%DEFINE_connectedbtncls%%">Connected</span>
                        </div>
                    </div>
                </div>
                <div style="display: none;">
                    <div class="signature_integration_box">

                        <h4><img src="%%DEFINE_IMAGE_LINK%%/images/exchange.svg" alt="">Microsoft Azure Active Directory</h4>
                        <p>Seamlessly integrate your Google Workspace with Custom Esignature to effortlessly manage and deploy email signatures across your organization.</p>
                        <ul>
                            <li>Unified Branding Control</li>
                            <li>Template Assignment based on user roles or departments</li>
                            <li>Easy Deployment</li>
                            <li>Single Sign-On</li>
                        </ul>
                        <div class="button_bg">
                            <a href="%%DEFINE_exchange_connect%%">Connect</a></div>
                    </div>
                </div>
            </div>
            {:IF}
        </div>
    </main>
</div>


    <div class="kt-modal kt-modal-center" data-kt-modal="true" id="DisconnectModalMS">
        <div class="kt-modal-content max-w-[400px]">
            <div class="kt-modal-header">
                <p class="kt-modal-title">Disconnect Custom eSignature from Outlook</p>
                <button type="button" class="kt-modal-close" aria-label="Close modal"
                    data-kt-modal-dismiss="#DisconnectModalMS">
                    <i class="disconnect-model-close hgi hgi-stroke hgi-cancel-circle text-2xl"></i>
                </button>
            </div>
            <div class="kt-modal-body">
                <p>All the signatures will be removed from the email accounts after the integration is disconnected. Are you sure you want to proceed?</p>
                <div class="flex justify-end gap-2 mt-4">
                    <button type="button" class="kt-btn kt-btn-mono" data-kt-modal-dismiss="#DisconnectModalMS">Cancel</button>
                    <button type="button" class="kt-btn kt-btn-primary disconnect" id="sendfeedback" data-id="0">Disconnect</button>
                </div>
            </div>
        </div>
    </div>

    <div class="kt-modal kt-modal-center" data-kt-modal="true" id="DisconnectModalGL">
        <div class="kt-modal-content max-w-[400px]">
            <div class="kt-modal-header">
                <p class="kt-modal-title">Disconnect Custom eSignature from Google Workspace</p>
                <button type="button" class="kt-modal-close" aria-label="Close modal"
                    data-kt-modal-dismiss="#DisconnectModalGL">
                    <i class="disconnect-model-close hgi hgi-stroke hgi-cancel-circle text-2xl"></i>
                </button>
            </div>
            <div class="kt-modal-body">
                <p>All the signatures will be removed from the email accounts after the integration is disconnected. Are you sure you want to proceed?</p>
                <div class="flex justify-center gap-2 mt-4">
                    <button type="button" class="kt-btn kt-btn-secondary" data-kt-modal-dismiss="#DisconnectModalGL">Cancel</button>
                    <button type="button" class="kt-btn kt-btn-primary disconnect" id="sendfeedback" data-id="1">Disconnect</button>
                </div>
            </div>
        </div>
    </div>

    <input type="hidden" id="form_url" value="%%DEFINE_integrations%%" />
    <input type="hidden" id="redirectintegration" value="%%DEFINE_integrations%%" />
    <input type="hidden" id="redirectazuread" value="%%DEFINE_azuread%%" />
    <input type="hidden" id="redirectgsuite" value="%%DEFINE_gsuite%%" />
    <input type="hidden" id="redirectgsuite_step3" value="%%DEFINE_google_connect%%/3" />
    <input type="hidden" id="redirectroot" value="%%DEFINE_ROOT_LINK%%" />
    <script src="%%DEFINE_JS_LINK%%/jquery-3.5.1.min.js"></script>
    <script>
        function myFunction(objid) {
            divobj = 'myDIV' + objid;
            var x = document.getElementById(divobj);

            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        }

        $(document).ready(function() {
            $('#step1-btn').on("click", function() {
                var error = 0;
                $('.error').addClass('hidden');
                if ($('#application_id').val() == "") {
                    $('#ai').removeClass('hidden');
                    var error = 1;
                }

                if ($('#application_secret').val() == "") {
                    $('#as').removeClass('hidden');
                    var error = 1;
                }

                if ($('#application_tenant').val() == "") {
                    $('#at').removeClass('hidden');
                    var error = 1;
                }
                if (error == 1) {
                    return false;
                }

                var form = $('#msazur');
                var formdata = form.serialize();
                $.ajax({
                    type: 'POST',
                    url: $('#form_url').val() + '/microsoft/connect',
                    data: formdata,
                    dataType: 'json',
                }).done(function(data) {
                    if (data.error == 0) {
                        $('#snackbar').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-green-600 rounded-xl relative bg-white bg-gradient-to-r from-[#00B71B]/12 to-[#00B71B]/0 shadow-lg"><img class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/success-message-icon.svg" alt=""><strong>Success! </strong>' + data.msg + ' </div>');
                        $('#snackbar').show();
                        setTimeout(function() {
                            $('#snackbar').hide();
                        }, 2000);
                        $('#msstep1').css('display', 'none');
                        $('#msstep2').css('display', 'block');
                    } else {
                        $('#snackbar-error').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-red-600 rounded-xl relative bg-white bg-gradient-to-r from-[#EB4545]/12 to-[#EB4545]/0 shadow-lg"><img draggable="false" class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/error-message-icon.svg" alt=""><strong>Failure! </strong>' + data.msg + ' </div>');
                        $('#snackbar-error').show();
                        setTimeout(function() {
                            $('#snackbar-error').hide();
                        }, 2000);
                    }
                    // Optionally alert the user of success here...
                }).fail(function(data) {
                    return false;
                    // Optionally alert the user of an error here...
                });
                return false;
            });

            // google connect

            $('#step1-btngl').on("click", function() {
                var error = 0;
                $('.error').addClass('hidden');
                var form = $('#gsuite');
                var formdata = form.serialize();
                $.ajax({
                    type: 'POST',
                    url: $('#form_url').val() + '/google/connect',
                    data: formdata,
                    dataType: 'json',
                }).done(function(data) {
                    if (data.error == 0) {
                        $('#snackbar').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-green-600 rounded-xl relative bg-white bg-gradient-to-r from-[#00B71B]/12 to-[#00B71B]/0 shadow-lg"><img class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/success-message-icon.svg" alt=""><strong>Success! </strong>' + data.msg + ' </div>');
                        $('#snackbar').show();
                        setTimeout(function() {
                            $('#snackbar').hide();
                            window.location = $('#redirectintegration').val();
                        }, 2000);
                    } else {
                        $('#snackbar-error').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-red-600 rounded-xl relative bg-white bg-gradient-to-r from-[#EB4545]/12 to-[#EB4545]/0 shadow-lg"><img draggable="false" class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/error-message-icon.svg" alt=""><strong>Failure! </strong>' + data.msg + ' </div>');
                        $('#snackbar-error').show();
                        setTimeout(function() {
                            $('#snackbar-error').hide();
                        }, 2000);
                    }
                    // Optionally alert the user of success here...
                }).fail(function(data) {
                    return false;
                    // Optionally alert the user of an error here...
                });
                return false;
            });

            // invite google workspace	
            $('#invite-btn').on("click", function() {
                $('#invite-btn').addClass('disabled-button');
                var error = 0;
                $('.error').addClass('hidden');
                if ($('#admin_firstname').val() == "") {
                    $('#ai').removeClass('hidden');
                    var error = 1;
                    setTimeout(function() {$('#ai').addClass('hidden');}, 2000);
                }

                if ($('#admin_lastname').val() == "") {
                    $('#as').removeClass('hidden');
                    var error = 1;
                    setTimeout(function() {$('#as').addClass('hidden');}, 2000);
                }

                if ($('#admin_email').val() == "") {
                    $('#at').removeClass('hidden');
                    var error = 1;
                    setTimeout(function() {$('#at').addClass('hidden');}, 2000);
                }
                if (error == 1) {
                    $('#invite-btn').removeClass('disabled-button');
                    return false;
                }
                var error = 0;
                $('.error').addClass('hidden');
                var form = $('#inviteadmin');
                var formdata = form.serialize();
                $.ajax({
                    type: 'POST',
                    // url: $('#form_url').val() + '/google/connect',
                    url: $('#form_url').val() + '/google/inviteGoogleAdmin',
                    data: formdata,
                    dataType: 'json',
                }).done(function(data) {
                    if (data.error == 0) {
                        $('#snackbar').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-green-600 rounded-xl relative bg-white bg-gradient-to-r from-[#00B71B]/12 to-[#00B71B]/0 shadow-lg"><img class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/success-message-icon.svg" alt=""><strong>Success! </strong>' + data.msg + ' </div>');
                        $('#snackbar').show();
                        setTimeout(function() {
                            $('#snackbar').hide();
                            window.location = $('#redirectroot').val();
                        }, 2000);
                    } else {
                        $('#snackbar-error').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-red-600 rounded-xl relative bg-white bg-gradient-to-r from-[#EB4545]/12 to-[#EB4545]/0 shadow-lg"><img draggable="false" class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/error-message-icon.svg" alt=""><strong>Failure! </strong>' + data.msg + ' </div>');
                        $('#snackbar-error').show();
                        setTimeout(function() {
                            $('#snackbar-error').hide();
                        }, 2000);
                    }
                    $('#invite-btn').removeClass('disabled-button');
                    // Optionally alert the user of success here...
                }).fail(function(data) {
                    $('#invite-btn').removeClass('disabled-button');
                    return false;
                    // Optionally alert the user of an error here...
                });
                return false;
            });



            // disconnect

            $('.disconnect').on("click", function() {
                var dataid = $(this).attr('data-id');
                var formdata = 'disconnect=1&platform=' + dataid;
                $.ajax({
                    type: 'POST',
                    url: $('#form_url').val(),
                    data: formdata,
                    dataType: 'json',
                }).done(function(data) {
                    $('.disconnect-model-close').click();
                    if (data.error == 0) {
                        $('#snackbar').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-green-600 rounded-xl relative bg-white bg-gradient-to-r from-[#00B71B]/12 to-[#00B71B]/0 shadow-lg"><img class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/success-message-icon.svg" alt=""><strong>Success! </strong>' + data.msg + ' </div>');
                        $('#snackbar').show();
                        setTimeout(function() {
                            $('#snackbar').hide();
                            window.location = $('#form_url').val();
                        }, 2000);
                    } else {
                        $('#snackbar-error').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-red-600 rounded-xl relative bg-white bg-gradient-to-r from-[#EB4545]/12 to-[#EB4545]/0 shadow-lg"><img draggable="false" class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/error-message-icon.svg" alt=""><strong>Failure! </strong>' + data.msg + ' </div>');
                        $('#snackbar-error').show();
                        setTimeout(function() {
                            $('#snackbar-error').hide();
                        }, 2000);
                    }
                    // Optionally alert the user of success here...
                }).fail(function(data) {
                    return false;
                    // Optionally alert the user of an error here...
                });
                return false;
            });


            $('#forcetoupdate').on("click", function() {
                var dataurl = $(this).attr('data-url');
                var formdata = 'forcetoupdate=1';
                $.ajax({
                    type: 'POST',
                    url: dataurl,
                    data: formdata,
                    dataType: 'json',
                }).done(function(data) {
                    if (data.error == 0) {
                        $('#snackbar').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-green-600 rounded-xl relative bg-white bg-gradient-to-r from-[#00B71B]/12 to-[#00B71B]/0 shadow-lg"><img class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/success-message-icon.svg" alt=""><strong>Success! </strong>' + data.msg + ' </div>');
                        $('#snackbar').show();
                        setTimeout(function() {
                            $('#snackbar').hide();
                        }, 2000);
                    } else {
                        $('#snackbar-error').html('<div class="gap-8 py-5 px-4 pl-11 border-l-9 border-red-600 rounded-xl relative bg-white bg-gradient-to-r from-[#EB4545]/12 to-[#EB4545]/0 shadow-lg"><img draggable="false" class="absolute left-4" src="%%DEFINE_IMAGE_LINK%%/images/error-message-icon.svg" alt=""><strong>Failure! </strong>' + data.msg + ' </div>');
                        $('#snackbar-error').show();
                        setTimeout(function() {
                            $('#snackbar-error').hide();
                        }, 2000);
                    }
                    // Optionally alert the user of success here...
                }).fail(function(data) {
                    return false;
                    // Optionally alert the user of an error here...
                });
                return false;
            });


            // To active/inactive in leftbar
            $('.new_dashboard_left a').removeClass('active');
            $('.new_dashboard_left .integrations').addClass('active');
            
        });
    </script>

    <script>
        $(document).ready(function() {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>

    %%DEFINE_FOOTER%%