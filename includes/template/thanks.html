 %%DEFINE_HEADER%%
	  
      <div class="new_signin_bg">
	<div class="row flex-column-reverse flex-md-row">
    	<div class="col-xl-4 col-lg-4 col-12">
        	<div class="signin_left_bg thank video">
            	<video width="100%" border="0" autoplay muted loop>
                    <source src="%%DEFINE_IMAGE_LINK%%/images/video/esign-signin-page.mp4" type="video/mp4">
                </video>
            </div>
        </div>
        <div class="col-xl-8 col-lg-8 col-12">
        	<div class="thanks_main">
            	<div class="top_logo"><img src="%%DEFINE_IMAGE_LINK%%/images/logo.svg" alt=""></div>
                <h3>Thank You, <span id="user_name"></span></h3>
                <p>Your account has been successfully created!</p>
                <div class="button_bg">
                   <a href="%%DEFINE_linkModuleLogin%%">Letâ€™s Login</a></div>
                </div>
            </div>
       </div>
    </div>    
      
       
   	   
 
    <script src="%%DEFINE_JS_LINK%%/jquery-3.5.1.min.js"></script>         
    <script>
      $(document).ready(function() {
        function getUrlParameter(sParam) {
          var sPageURL = window.location.search.substring(1),
          sURLVariables = sPageURL.split('&'),sParameterName,i;
          for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] === sParam) {
              return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
            }
          }
          return false;
        };
        var datalayerRawData = getUrlParameter('datalayer');
        var datalayer = JSON.parse(datalayerRawData);
        var transaction_id = datalayer['subscription_id'];
        var plan_id = datalayer['plan_id'];
        var plan_name = datalayer['plan_name'];
        var plan_status = datalayer['plan_status'];
        var customer_id = datalayer['customer_id'];
        var subscription_id = datalayer['subscription_id'];
        var price_id = datalayer['price_id'];
        var plan_interval = datalayer['plan_interval'];
        var plan_signaturelimit = datalayer['plan_signaturelimit'];
        var period_start = datalayer['period_start'];
        var period_end = datalayer['period_end'];
        var invoice_amount = datalayer['invoice_amount'];
        var invoice_link = datalayer['invoice_link'];
        var apply_coupon = datalayer['apply_coupon'];
        var auto_renew = datalayer['auto_renew'];
        var free_trial = datalayer['free_trial'];
        var plan_cancel = datalayer['plan_cancel'];
        var item_variant = 'quarterly';
        if(plan_interval == 'month'){
          var item_variant = 'quarterly';
        }
        else if(plan_interval == 'year'){
          var item_variant = 'yearly';
        }

        var user_first_name = datalayer['user_data']['user_firstname'];
        var user_last_name = datalayer['user_data']['user_lastname'];
        var user_email = datalayer['user_data']['user_email'];
        var user_phone = datalayer['user_data']['user_phone'];
        var user_organization = datalayer['user_data']['user_organization'];

        $('#user_name').html(datalayer['user_name'])
        const purchaseEvent = {
          event: "purchase",
          ecommerce: {
            currency: "USD",
            value: invoice_amount,
            tax: "0.00",
            shipping: "0.00",
            transaction_id: transaction_id,
            affiliation: user_organization,
            coupon: "",
            items: [
              {
                item_id : plan_id,
                item_name : plan_name,
                price : invoice_amount,
                quantity: plan_signaturelimit,
                item_brand: user_organization,
                item_category: 'subscription',
                item_variant: item_variant
              }
            ],
            plan_status : plan_status,
            customer_id : customer_id,
            subscription_id : subscription_id,
            price_id : price_id,
            plan_interval : plan_interval,
            plan_signaturelimit : plan_signaturelimit,
            period_start : period_start,
            period_end : period_end,
            invoice_link : invoice_link,
            apply_coupon : apply_coupon,
            auto_renew : auto_renew,
            free_trial : free_trial,
            plan_cancel : plan_cancel
          },
          user_data: {
            first_name: user_first_name,
            last_name: user_last_name,
            email_hash: user_email,
            phone_number_hash: user_phone
          },
          ga4_event_parameters: {
            signature_limit: plan_signaturelimit,
            plan_interval: plan_interval
          }
        };

        // Push to dataLayer
        dataLayer.push(purchaseEvent);
        console.log("Pushed purchase event to dataLayer:", purchaseEvent);

     });
    </script>
  
   
%%DEFINE_FOOTER%%