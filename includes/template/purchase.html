%%DEFINE_HEADER%%
<style>
  .header_bg .icon_right_side a.tutorial{ display: none;}
</style>
<script src="https://accounts.google.com/gsi/client" async defer></script> 
<script src="https://js.stripe.com/v3/"></script>

<div class="flex grow flex-col in-data-kt-[sticky-header=on]:pt-(--header-height-default) overflow-auto">
  <main class="h-full" id="content" role="content">
    <div class="kt-container-fluid p-4 h-full">
      <div id="register-error">%%DEFINE_Message%%</div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-8 xl:gap-10">
        <a href="%%DEFINE_ROOT_LINK%%/dashboard" class="!size-8 kt-btn text-gray-600 !bg-transparent border !border-primary bg-gradient-to-r from-[#26B7FF]/20 to-[#1D4AFE]/20 kt-btn-icon absolute top-4 right-4 z-2">
          <i class="hgi hgi-stroke hgi-cancel-01"></i>
        </a>
        <div class="bg-gray-100 border border-gray-300 p-5 rounded-2xl md:rounded-4xl" id="order-main">
          <div class="flex flex-wrap items-center justify-between mb-3 sm:mb-4 md:mb-5 lg:mb-6 xl:mb-8 2xl:mb-10">
            <div>
              <h4 class="font-bold">Start Your <span
                  class="bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent">7-day Free
                  Trial!</span></h4>
              <h5>Choose Your Plan</h5>
              <p class="bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent">Cancel Anytime</p>
            </div>
            <div class="flex items-center gap-2">
              <div class="flex items-center gap-2">
                <span>Monthly</span>
                <input class="kt-switch" type="checkbox" role="switch" id="plan_type" name="checkbox" checked>
              </div>
              <div class="flex items-center gap-2">
                <span>Yearly</span>
                <span class="kt-badge rounded-full bg-gradient-to-r from-[#26B7FF]/10 to-[#1D4AFE]/10">Save 20%</span>
              </div>
            </div>
          </div>
          <p class="mb-3">How many signatures do you need?</p>
          <input type="hidden" id="plan_unit" name="plan_unit" value="%%DEFINE_plan_selunit%%" />
          <div class="kt-card bg-transparent sm:bg-white border-0 sm:border-[1px] shadow-none w-full max-sm:max-w-[90%] mx-auto">
            <div class="kt-card-content relative px-0 sm:p-10 pt-10 sm:pt-16 sm:pr-12">
              <div class="relative">
                  <div class="rangeTooltip text-xs" id="tooltip">1 Signatures</div>
                  <input type="range" class="appearance-none block !h-5 relative z-[1] bg-transparent !w-full"
                    id="rangeSlider" min="0" max="8" step="1" value="0">
                  <div class="h-1.5 bg-gray-200 absolute w-full top-1/2 -translate-y-1/2 rounded-full"></div>
                  <div class="h-1.5 absolute top-1/2 -translate-y-1/2 rounded-full bg-gradient" id="fillTreck"></div>
                </div>
                <div class="labels hidden lg:flex justify-between mt-4 *:w-6 *:text-center" id="labels"></div>
            </div>
          </div>
          <!-- <div class="kt-card mt-3">
            <div class="kt-card-content">
              <div id="range" class="noUi-target noUi-ltr noUi-horizontal"></div>
              <div class="lg:flex justify-between mt-5 hidden">
                <span class="rno active" id="rno1">1</span>
                <span class="rno" id="rno3">3</span>
                <span class="rno" id="rno5">5</span>
                <span class="rno" id="rno10">10</span>
                <span class="rno" id="rno15">15</span>
                <span class="rno" id="rno20">20</span>
                <span class="rno" id="rno25">25</span>
                <span class="rno" id="rno30">30</span>
                <span class="rno" id="rno35">35</span>
                <span class="rno" id="rno40">40</span>
                <span class="rno" id="rno45">45</span>
                <span class="rno" id="rno50">50</span>
                <span class="rno" id="rno55">55</span>
                <span class="rno" id="rno60">60</span>
                <span class="rno" id="rno65">65</span>
                <span class="rno" id="rno70">70</span>
                <span class="rno" id="rno75">75</span>
                <span class="rno" id="rno80">80</span>
                <span class="rno" id="rno85">85</span>
                <span class="rno" id="rno90">90</span>
                <span class="rno" id="rno95">95</span>
                <span class="rno" id="rno100">100</span>
              </div>
            </div>
          </div> -->
          <div class="hidden kt-card mt-5 relative rounded-2xl" id="monthly-tab-panel">
            <img src="%%DEFINE_IMAGE_LINK%%/images/topLeft.png" class="-top-[24px] -left-[24px] max-w-[335px] sm:max-w-[fit-content] absolute">
            <img src="%%DEFINE_IMAGE_LINK%%/images/topLeft.png" class="-right-[27px] -bottom-[27px] max-w-[335px] sm:max-w-[fit-content] absolute rotate-180">
            <div class="signature_layot kt-card-content p-5 lg:p-8" style="background: url('%%DEFINE_IMAGE_LINK%%/images/FreeTrial1.png') no-repeat top right">
              <input type="radio" name="plan_id" id="plan_id2" data-section="monthly" class="hidden imgbgchk" value="2" required="required" %%DEFINE_plan_selplan2%%>
              <label for="plan_id2" class="changeprice" data-price="20">
                <div class="order_details_box border-price">
                  <h5 class="font-bold">Pro Plan</h5>
                  <!-- <p><span class="offper_box"><span>Change to yearly, save 20%</span></span></p> -->
                  <p><span class="no_employee_qarter">5</span> Signature</p>
                  <p class="monthprice" style="display:none;">$<span class="month_propricespl cpricespl">60</span> USD </p>
                  <p class="bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent">14-Day Risk-Free Guarantee</p>
                  <!-- <p class="line-through font-bold text-gray-500 mt-4 sm:mt-5 md:mt-6 lg:mt-7 xl:mt-10">$ 30</p> -->
                  <div class="flex items-start sm:items-end flex-col sm:flex-row gap-3 mt-4 sm:mt-5 md:mt-6 lg:mt-7 xl:mt-10">
                    <h2 class="font-semibold">$<span class="month_proprice cprice">0</span>/mo</h2>
                    <span class="kt-badge bg-[#B7FFD3] mb-2 rounded-full">Change to yearly, save 20%</span>
                  </div>
                  <p class="text-gray-400 my-1">Billed Monthly</p>
                  <p class="text-gray-400">Full animation features with advanced layouts, interactive icons, team management and auto-deployment.</p>
                  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-1 lg:grid-cols-2 mt-6 pt-6 border-t border-t-gray-200 gap-2">
                    <ul class="space-y-2">
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Interactive Signature</li>
                      <li class="gap-1 flex items-center"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Verification Badge <img class="mt-0.5" src="%%DEFINE_IMAGE_LINK%%/images/verification-badge1.svg" alt=""></li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Interactive Social Icons</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Pro Templates</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Analytics</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Customer Support</li>
                    </ul>
                    <ul class="space-y-2">
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>AI - Logo Animationâ„¢</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Remove CES Watermark</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Animated Profile</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Team Dashboard</li>
                      <li class="gap-1 flex items-center"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Outlook and Gmail Sync <img class="mt-0.5" src="%%DEFINE_IMAGE_LINK%%/images/gmail-icon1.svg" alt=""> <img class="mt-0.5" src="%%DEFINE_IMAGE_LINK%%/images/outlook-icon1.svg" alt=""></li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Instant Load Speed</li>
                    </ul>
                  </div>
                </div>
              </label>
            </div>
          </div>
          <div id="yearly-tab-panel" class="kt-card mt-5 relative rounded-2xl">
            <img src="%%DEFINE_IMAGE_LINK%%/images/topLeft.png" class="-top-[26px] -left-[26px] max-w-[335px] sm:max-w-[fit-content] absolute">
            <img src="%%DEFINE_IMAGE_LINK%%/images/topLeft.png" class="-right-[27px] -bottom-[27px] max-w-[335px] sm:max-w-[fit-content] absolute rotate-180">
            <div class="kt-card-content p-5 lg:p-8" style="background: url('%%DEFINE_IMAGE_LINK%%/images/FreeTrial1.png') no-repeat top right">
              <input type="radio" name="plan_id" id="plan_id4" data-section="yearly" class="hidden imgbgchk" value="4" required="required" %%DEFINE_plan_selplan4%%>
              <label for="plan_id4" class="changeprice" data-price="20">
                <h5 class="font-bold">Pro Plan</h5>
                <p><span class="no_employee_qarter">5</span> Signature</p>
                <p class="yearprice" style="display:none;">$<span class="year_propricespl cpricespl">60</span> USD</p>
                <p class="bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent">14-Day Risk-Free Guarantee</p>
                <p class="line-through font-bold text-gray-500 mt-4 sm:mt-5 md:mt-6 lg:mt-7 xl:mt-10">$<span class="year_propricespl">0</span></p>
                <div class="flex items-end gap-3">
                  <h2 class="font-semibold">$<span class="year_proprice cprice">0</span> /mo </h2>
                  <!-- <span class="kt-badge bg-[#B7FFD3] mb-2 rounded-full">First Month 50% OFF</span> -->
                </div>
                <p class="text-gray-400 my-1">Billed Yearly</p>
                <p class="text-gray-400">Full animation features with advanced layouts, interactive icons, team management and auto-deployment.</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-1 lg:grid-cols-2 mt-6 pt-6 border-t border-t-gray-200 gap-2">
                  <ul class="space-y-2">
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Interactive Signature</li>
                      <li class="gap-1 flex items-center"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Verification Badge <img class="mt-0.5" src="%%DEFINE_IMAGE_LINK%%/images/verification-badge1.svg" alt=""></li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Interactive Social Icons</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Pro Templates</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Analytics</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Customer Support</li>
                    </ul>
                    <ul class="space-y-2">
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>AI - Logo Animationâ„¢</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Remove CES Watermark</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Animated Profile</li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Team Dashboard</li>
                      <li class="gap-1 flex items-center"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Outlook and Gmail Sync <img class="mt-0.5" src="%%DEFINE_IMAGE_LINK%%/images/gmail-icon1.svg" alt=""> <img class="mt-0.5" src="%%DEFINE_IMAGE_LINK%%/images/outlook-icon1.svg" alt=""></li>
                      <li class="gap-1 flex items-start"><i class="hgi hgi-stroke hgi-tick-02 bg-gradient-to-r from-[#26B7FF] to-[#1D4AFE] bg-clip-text text-transparent text-lg"></i>Instant Load Speed</li>
                    </ul>
                </div>
              </label>
            </div>
          </div>
        </div>

        <div class="space-y-4 pb-4">
        <div class="mb-4 pointer-events-none">
          %%DEFINE_USER_SIGNATURE%%
        </div>
        <form action="%%DEFINE_PAYMENT_FORM_ACTION_URL%%" id="paymentform" method="post" data-rewardful>

          <div class="flex flex-col gap-4">
            <div class="card_info">
              <!-- <div id="card-element" class="w-full"></div> -->
              <div id="card-element" class="grid grid-cols-2 gap-4">
                <div class="col-span-2">
                  <label class="kt-form-label">Card Number</label>
                  <div id="card-number-element" class="kt-input !block pt-3"></div>
                </div>
                <div>
                  <label class="kt-form-label">Expiry date</label>
                  <div id="card-expiry-element" class="kt-input !block pt-3"></div>
                </div>
                <div>
                  <label class="kt-form-label">Security code</label>
                  <div id="card-cvc-element" class="kt-input !block pt-3"></div>
                </div>
              </div>
              <div id="paymentResponse"></div>
            </div>
            <div>
              <label class="kt-form-label">Name on Card</label>
              <input type="text" class="kt-input" name="user_nameoncard" value="%%DEFINE_user_nameoncard%%" id="card_name" placeholder="Name on Card">
            </div>
            <div>
              <label class="kt-form-label">Discount Code</label>
              <div class="flex gap-2">
                <input type="text" id="promo_code" class="kt-input" id="" placeholder="">
                <input type="hidden" id="coupon_id" name="coupon_id" value="" />
                <button type="button" class="kt-btn kt-btn-primary applied" id="apply_promocode">Apply Now</button>
                <button type="button" class="kt-btn kt-btn-icon kt-btn-destructive applied hidden" id="applied_promocode">
                  <i class="hgi hgi-stroke hgi-delete-02"></i>
                </button>
              </div>
            </div>
          </div>

          <p class="special_offet" id="couponResponse"></p>
          <div class="mt-5">
            <h5 class="mb-3">Order Summary</h5>
            <div class="border border-gray-200 rounded-2xl p-4 flex flex-col gap-3 text-gray-400">
              <div class="flex items-center justify-between">
                <span>Subtotal</span>
                <span id="subtotal">%%DEFINE_plan_format_pricespl%% USD</span>
              </div>
              <div class="flex items-center justify-between">
                <span>Discount</span>
                <span id="discount">$0 USD</span>
              </div>
              <div class="flex items-center justify-between text-primary" id="savings-main-div">
                <span>Saving</span>
                <span id="savings">%%DEFINE_plan_format_savings%% USD</span>
              </div>
              <div class="flex items-center justify-between text-gray-950 text-xl font-semibold border-t border-t-gray-200 pt-4">
                <span>Total due today %%DEFINE_freetrialtext%%</span>
                <span>$0.00 USD</span>
              </div>
              <div class="flex items-center justify-between">
                <span>Due on <span id="freetrialduedate">Aug 22 2025</span></span>
                <span class="total" id="total">%%DEFINE_plan_format_price%% USD</span>
              </div>
              <input type="hidden" id="free_trial" value="0" />
              <input type="hidden" name="totalpay" id="totalpay" value="%%DEFINE_plan_price_hiden%%"  />
            </div>
          </div>
            
          <div class="flex flex-col justify-center gap-2 mt-4">
            <input type="hidden" name="paymentsubmit" value="1" />
            <input type="hidden" name="plan_id" id="form_plan_id" value="%%DEFINE_plan_id%%" />
            <input type="hidden" name="plan_unit" id="form_plan_unit" value="%%DEFINE_plan_unit%%" />
            <input type="hidden" name="user_id" value="%%DEFINE_PAYMENT_USER_ID%%" />
            <input type="hidden" name="user_email" value="%%DEFINE_PAYMENT_USER_EMAIL%%" />
            <input type="hidden" name="user_name" value="%%DEFINE_PAYMENT_USER_NAME%%" />
            <button type="submit" id="payment_button" name="signin" class="kt-btn kt-btn-primary">Confirm Purchase</button>
          </div>
            
          <ul class="flex items-center justify-between mt-5">
            <li class="flex items-center gap-2"><img src="%%DEFINE_IMAGE_LINK%%/images/ssl-icon.svg" alt="">SSL Secure Checkout</li>
            <li class="flex items-center gap-2"><img src="%%DEFINE_IMAGE_LINK%%/images/cancel-anytime-icon.svg" alt="">Cancel anytime</li>
            <li class="flex items-center gap-2"><img src="%%DEFINE_IMAGE_LINK%%/images/risk-free-icon.svg" alt="">14-Day Risk-Free Guarantee</li>
          </ul>
        </form>
      </div>
    </div>
</div>
</div>
<!-- pricing plan change based on slider -->
<script src="%%DEFINE_JS_LINK%%/jquery-3.5.1.min.js"></script>
<script src="%%DEFINE_JS_LINK%%/nouislider/nouislider.min.js"></script>
<script type="text/javascript">

  
function initCustomSliderPurchase(
      values = [1, 3, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100],
      sliderId = "rangeSlider",
      tooltipId = "tooltip",
      labelsId = "labels",
      fillId = "fillTreck"
  ) {
      const slider = document.getElementById(sliderId);
      const tooltip = document.getElementById(tooltipId);
      const labelsContainer = document.getElementById(labelsId);
      const rangeBg = document.getElementById(fillId);

      slider.max = values.length - 1;
      const thumbWidth = 24; // known thumb width

      // Generate labels
      labelsContainer.innerHTML = "";
      values.forEach((val, i) => {
          const span = document.createElement("span");
          span.textContent = val;
          const percent = (i / (values.length - 1)) * 100;
          span.style.left = percent + "%";
          labelsContainer.appendChild(span);
      });

      function updateUI() {
          const index = parseInt(slider.value);
          const value = values[index];
          const percent = index / (values.length - 1);

          // Ensure correct width including padding
          const sliderRect = slider.getBoundingClientRect();
          const sliderWidth = sliderRect.width;

          // Compute tooltip left position
          const computedLeft = percent * (sliderWidth - thumbWidth) + thumbWidth / 2;
          tooltip.style.left = computedLeft + "px";
          tooltip.style.transform = "translateX(-50%)";

          tooltip.textContent = `${value} Signature${value > 1 ? 's' : ''}`;

          // Update filled track
          rangeBg.style.width = (percent * 100) + "%";

          if (typeof updatePurchasePlanDetails === 'function') {
            updatePurchasePlanDetails(value);
        }
      }

      // Make sure tooltip positions correctly after DOM is fully ready
      window.addEventListener("load", updateUI);
      slider.addEventListener("input", updateUI);
      window.addEventListener("resize", updateUI);
  }

  function updateSelectPlan(){
      
      // if(isFreeTrial){
      //   return false;
      // }

      if($('input[name=plan_id]:checked').val() < 3){
        multiplyprice = 1;
      }else{
        multiplyprice = 12;
      }
      var radioObj = $('input[name=plan_id]:checked');
      planpriceint = parseFloat(radioObj.parent().find('label span.cprice').text() * multiplyprice);
      planpricesplint = parseFloat(radioObj.parent().find('label span.cpricespl').text() * multiplyprice);
      totalsavings = parseFloat(planpricesplint - planpriceint);  

      if(multiplyprice == 1){
        $('#savings-main-div').hide();
        $('#subtotal').text('$'+planpriceint.toFixed(2)+' USD');
        $('#total').text('$'+planpriceint.toFixed(2)+' USD'); 
      }else{
        $('#savings-main-div').show();
        $('#subtotal').text('$'+planpricesplint.toFixed(2)+' USD');
        $('#savings').text('$'+totalsavings.toFixed(2)+' USD');
        $('#total').text('$'+planpriceint.toFixed(2)+' USD'); 
      }
      
      var selectedplan = radioObj.parent().find('label').html();
      $('#selected-plan').html(selectedplan);
      // $('#selectplan-main').toggle();
      // $('#order-main').toggle();
      //for discount calcultion
      $('#totalpay').val(planpriceint);
      
      $('#coupon_id').val('');
      $('#promo_code').val('');
      $('#couponResponse').text('');
      $('#discount').text('$0.00 USD');
      $("#apply_promocode").removeClass('hidden');
      $("#applied_promocode").addClass('hidden');
    };

  function updatePurchasePlanDetails(value){
    //if(unencoded == 0 ) {unencoded = $('#plan_unit').val();}
    //  if(unencoded == 0 ) {unencoded = 1;}
    //  if( unencoded == '39.99999999999999') { unencoded = 40;}
    //  if( unencoded == '74') { unencoded = 75;}
    //  unencoded = unencoded.slice(0, 2);
    let today = new Date();
    today.setDate(today.getDate() + 7);
    let options = { month: 'short', day: '2-digit', year: 'numeric' };
    let formatted = today.toLocaleDateString('en-US', options).replace(',', '');
    $("#freetrialduedate").html(formatted);



    unencoded = value;
    unencoded = parseInt(unencoded);
      if(unencoded == 0 ) {unencoded = [1];}
      $("#form_plan_unit").val(unencoded);
    
      $('#plan_unit').val(unencoded);
      $('.no_employee_qarter').text(unencoded);
    // month price changhe
      var pro_month_unit = JSON.parse('%%DEFINE_pro_month_unit%%');
      var pro_month_unitspl = JSON.parse('%%DEFINE_pro_month_unitspl%%');
      $('.month_proprice').text(pro_month_unit[unencoded]);
      $('.month_propricespl').text(pro_month_unitspl[unencoded]);
    // year price changhe
      var pro_year_unit = JSON.parse('%%DEFINE_pro_year_unit%%');
      var pro_year_unitspl = JSON.parse('%%DEFINE_pro_year_unitspl%%');
      $('.year_proprice').text(pro_year_unit[unencoded]);
      $('.year_propricespl').text(pro_year_unitspl[unencoded]);
      var radioObj = $('input[name=plan_id]:checked');
      if($('input[name=plan_id]:checked').val() < 3){
      multiplyprice = 1;
      }else{
      multiplyprice = 12;
      }
      planpriceint = parseFloat(radioObj.parent().find('label span.cprice').text() * multiplyprice);
    
      $(".rno").removeClass("active");
      $("#rno"+unencoded).addClass("active");

      updateSelectPlan();
      // updateGpayButton(planpriceint.toFixed(2));
  }

  initCustomSliderPurchase();

  $(document).ready(function(){
    var start = "%%DEFINE_plan_unit%%";
    updatePurchasePlanDetails(start);
    const slider = $('#rangeSlider')[0];
    const tooltip = $('#tooltip')[0];
    const customThumb = $('#customThumb')[0];
    const rangeBg = $('#fillTreck')[0];
    const values = [1, 3, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100];
    const indexToSet = values.indexOf(parseInt(start));
    slider.value = indexToSet;

    updateUI();

    function updateUI() {
      const index = parseInt(slider.value);
      const value = values[index];
      const percent = (index / (values.length - 1)) * 100;
      const sliderWidth = slider.offsetWidth;
      const posX = (percent / 100) * sliderWidth;

      tooltip.style.left = posX + "px";
      tooltip.textContent = `${value} Signature`;

      customThumb.style.left = posX + "px";
      rangeBg.style.width = percent + "%";
    }

    var activePlanId = "%%DEFINE_plan_id%%";
    if(activePlanId == 7){
      setTimeout(function(){ $('#plan_type').click();}, 100);
    }
  });


  jQuery.noConflict();
    (function($) {
    if ($('input[name="plan_id"]:checked').length === 0) {
      $("#yearly-tab-panel").removeClass('hidden');
      $("#monthly-tab-panel").addClass('hidden');
      $("#plan_id4").prop('checked', true);
      $("#form_plan_id").val(8);
    }else{
      if($('input[name="plan_id"]:checked').data('section') == 'monthly'){
        $('#plan_type').prop('checked', false);
        $("#monthly-tab-panel").removeClass('hidden');
        $("#yearly-tab-panel").addClass('hidden');
        $("#plan_id2").prop('checked', true);
        $("#form_plan_id").val(7);
      }else{
        $('#plan_type').prop('checked', true);
        $("#yearly-tab-panel").removeClass('hidden');
        $("#monthly-tab-panel").addClass('hidden');
        $("#plan_id4").prop('checked', true);
        $("#form_plan_id").val(8);
      }
    }
    $(document).ready(function(){
      $('#plan_type').on('change', function() {
        if ($(this).is(':checked')) {
          $("#yearly-tab-panel").removeClass('hidden');
          $("#monthly-tab-panel").addClass('hidden');
          $("#plan_id4").prop('checked', true);
          $("#form_plan_id").val(8);
        } else {
          $("#month-tab").click();
          $("#monthly-tab-panel").removeClass('hidden');
          $("#yearly-tab-panel").addClass('hidden');
          $("#plan_id2").prop('checked', true);
          $("#form_plan_id").val(7);
        }
        updateSelectPlan();
    });
    });
  })(jQuery);
</script>
<script>
  setTimeout(function(){ $('#register-error').html(''); }, 10000); // hide error message after 10 sec

  
  

  function updateGpayButton(price){
    const stripe = Stripe("pk_test_51Lf5JtHp7DgNkCIvskUjNu75xBD5bJCrsAgaPf0ZT9al8jfTzcJXG8TwD1NZMI03qqINPFFIrrYHuJSN5n9ubfD100czetLSeB");
    price = price * 100;

    // Configure PaymentRequest
    const paymentRequest = stripe.paymentRequest({
      country: 'US', // Change based on your business location
      currency: 'usd',
      total: {
        label: 'Your Product Name',
        amount: price, // Amount in cents (e.g., $50.00)
      },
      requestPayerName: true,
      requestPayerEmail: true,
    });

    // Check for PaymentRequestButton support
    const elements = stripe.elements();
    paymentRequest.canMakePayment().then(function(result) {
      if (result && result.googlePay) {
        const prButton = elements.create('paymentRequestButton', {
          paymentRequest: paymentRequest,
        });

        // Mount the button in the container
        prButton.mount('#googlepay-button');
      } else {
        // document.getElementById('googlepay-button').style.display = 'none';
      }
    });
    var url = $('#ajax_url').val();
    var user_firstname = $('#user_firstname').val();
    var user_lastname = $('#user_lastname').val();
    var user_organization = $('#user_organization').val();
    var user_email = $('#user_email').val();
    var user_password = $("#user_password").val();
    var plan_id = $("input[name=plan_id]:checked").val();
    var plan_unit = $("#plan_unit").val();

    

  // Handle token received from Google Pay
    paymentRequest.on('paymentmethod', function(ev) {
      // Send the token to your server (via AJAX, for example)
      var url = $('#ajax_url').val();
      var user_firstname = $('#user_firstname').val();
      var user_lastname = $('#user_lastname').val();
      var user_organization = $('#user_organization').val();
      var user_email = $('#user_email').val();
      var user_password = $("#user_password").val();
      var plan_id = $("input[name=plan_id]:checked").val();
      var plan_unit = $("#plan_unit").val();

      if(user_firstname == ''|| user_firstname == ' '){
        $("#register-error").html('<div class="alert alert-danger" role="alert">Please Enter valid First Name</div>');
        setTimeout(function(){ $("#register-error").empty();$("#register-error").html('');}, 3000);
      } else if(user_lastname == ''|| user_lastname == ' '){
        $("#register-error").html('<div class="alert alert-danger" role="alert">Please Enter valid Last Name</div>');
        setTimeout(function(){ $("#register-error").empty();$("#register-error").html('');}, 3000);
      }else if(user_organization == ''|| user_organization == ' '){
        $("#register-error").html('<div class="alert alert-danger" role="alert">Please Enter valid Company Name</div>');
        setTimeout(function(){ $("#register-error").empty();$("#register-error").html('');}, 3000);
      }else if(user_email == ''|| user_email == ' '){
        $("#register-error").html('<div class="alert alert-danger" role="alert">Please Enter valid User Email</div>');
        setTimeout(function(){ $("#register-error").empty();$("#register-error").html('');}, 3000);
      }else if(user_password == ''|| user_password == ' '){
        $("#register-error").html('<div class="alert alert-danger" role="alert">Please Enter valid password</div>');
        setTimeout(function(){ $("#register-error").empty();$("#register-error").html('');}, 3000);
      }
      fetch('/processpayment', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ payment_method: ev.paymentMethod.id,price:price, user_firstname:user_firstname, user_lastname:user_lastname, user_organization:user_organization, user_email:user_email, user_password:user_password, plan_id:plan_id, plan_unit:plan_unit}),
      })
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            ev.complete('fail');
          } else {
            ev.complete('success');
            window.location.href = $("#thank_url").val();
          }
        });
      });
  }
 
  /*
  start = $('#plan_unit').val();
  var rangeSlider = $('#range')[0];
    noUiSlider.create(rangeSlider, {
      start: [start],
      behaviour: 'tap', //drag
      step: 5,
      connect: [true, false],
      range: {
        'min': [1],
        '4%': [3, 2],
        '7%': [5, 5],
        'max': [100]
      }
    });
  
  rangeSlider.noUiSlider.on('update', function( values, handle,unencoded ) {
     //if(unencoded == 0 ) {unencoded = $('#plan_unit').val();}
    //  if(unencoded == 0 ) {unencoded = 1;}
    //  if( unencoded == '39.99999999999999') { unencoded = 40;}
    //  if( unencoded == '74') { unencoded = 75;}
    //  unencoded = unencoded.slice(0, 2);
    unencoded = values;
    unencoded = parseInt(unencoded);
     if(unencoded == 0 ) {unencoded = [1];}
     $("#form_plan_unit").val(unencoded);
    
     $('#plan_unit').val(unencoded);
     $('.no_employee_qarter').text(unencoded);
    // month price changhe
     var pro_month_unit = JSON.parse('%%DEFINE_pro_month_unit%%');
     var pro_month_unitspl = JSON.parse('%%DEFINE_pro_month_unitspl%%');
     $('.month_proprice').text(pro_month_unit[unencoded]);
     $('.month_propricespl').text(pro_month_unitspl[unencoded]);
    // year price changhe
     var pro_year_unit = JSON.parse('%%DEFINE_pro_year_unit%%');
     var pro_year_unitspl = JSON.parse('%%DEFINE_pro_year_unitspl%%');
     $('.year_proprice').text(pro_year_unit[unencoded]);
     $('.year_propricespl').text(pro_year_unitspl[unencoded]);
     var radioObj = $('input[name=plan_id]:checked');
     if($('input[name=plan_id]:checked').val() < 3){
      multiplyprice = 1;
     }else{
      multiplyprice = 12;
     }
     planpriceint = parseFloat(radioObj.parent().find('label span.cprice').text() * multiplyprice);
   
     $(".rno").removeClass("active");
     $("#rno"+unencoded).addClass("active");

     updateSelectPlan();
     updateGpayButton(planpriceint.toFixed(2));
  });

  */
  

// chek plan coupon is valid

  $(document).ready(function(){
    $("#apply_promocode").click(function(){
      $('#paymentResponse').html('');
      $('#coupon_id').val('');
      var promo_code = $('#promo_code');
      var freetrial = $('#free_trial').val();
      if(promo_code.val() == ""){
        promo_code.focus(); return false;
      }else{
        var url = $('#ajax_url').val();
        jQuery.ajax({
        url: url,
        data:'coupon_apply=1&coupon_code='+promo_code.val(),
        type: "POST",
        dataType:"json",
        async: false,
        success:function(data){
            if(data['coupon_id'] !=0){
              $('#coupon_id').val(data['coupon_id']);
              
              totalValue = $('#totalpay').val();
              if(data['coupon_type'] == 'per'){
                discount =  ((totalValue * data['coupon_amount']) / 100).toFixed(2);
                totalpay = (totalValue - discount).toFixed(2);
              }else{
                discount =  (data['coupon_amount']).toFixed(2);
                totalpay = (totalValue - discount).toFixed(2);
              }
              
              if(freetrial == 0){
                $('#discount').text('$'+discount+' USD');
                $('#total').text('$'+totalpay+' USD');
                $("#apply_promocode").addClass('hidden');
                $("#applied_promocode").removeClass('hidden');
              }else{
                $('#subtotal').text('$'+totalpay+' USD');
                $('#discount').text('$'+discount+' USD');
              }
            }
          $('#couponResponse').html(data['msg']);
        },
        error:function (){ 
          clearconsole(); 
        }
        });
      }
    });
    
    $("#applied_promocode").click(function(){
      $('#coupon_id').val('');
      $('#promo_code').val('');
      totalPay = $('#totalpay').val();
      totalPay = parseFloat(totalPay).toFixed(2);
      $('#discount').text('$0 USD');  
      $('#total').text('$'+totalPay+' USD');
      $('#couponResponse').html('<span style="color:#F00;">Discount code removed!</span>');
      $("#apply_promocode").removeClass('hidden');
      $("#applied_promocode").addClass('hidden');
    })  
  });  

</script>
<!-- end pricing plan change based on slider -->  


<script>
  // Create an instance of the Stripe object
  // Set your publishable API key
  var stripe = Stripe('%%DEFINE_STRIPE_PUBLISHABLE_KEY%%');

  // Create an instance of elements
  var elements = stripe.elements();

  var style = {
    base: {
      color: "#32325d",
      fontFamily: 'Switzer, sans-serif',
      fontSmoothing: "antialiased",
      fontSize: "13px",
      "::placeholder": {
        color: "#9f9fa9"
      }
    },
    invalid: {
      fontFamily: 'Arial, sans-serif',
      color: "#fa755a",
      iconColor: "#fa755a"
    }
  };

  // Create individual elements
  var cardNumber = elements.create('cardNumber', { style: style });
  var cardExpiry = elements.create('cardExpiry', { style: style });
  var cardCvc = elements.create('cardCvc', { style: style });

  // Mount to respective divs
  cardNumber.mount('#card-number-element');
  cardExpiry.mount('#card-expiry-element');
  cardCvc.mount('#card-cvc-element');

  // Handle validation errors
  var resultContainer = document.getElementById('paymentResponse');

  function setError(event) {
    if (event.error) {
      resultContainer.innerHTML = '<p style="color:#F00;">' + event.error.message + '</p>';
    } else {
      resultContainer.innerHTML = '';
    }
  }

  cardNumber.on('change', setError);
  cardExpiry.on('change', setError);
  cardCvc.on('change', setError);

  // Old code for the card field
  /*

  var style = {
    base: {
      color: "#32325d",
      fontFamily: 'Roboto, sans-serif',
      fontSmoothing: "antialiased",
      fontSize: "13px",
      "::placeholder": {
        color: "#32325d"
      }
    },
    invalid: {
      fontFamily: 'Arial, sans-serif',
      color: "#fa755a",
      iconColor: "#fa755a"
    }
  };

  var cardElement = elements.create("card", {   hidePostalCode: true, style: style });
  // Stripe injects an iframe into the DOM
  cardElement.mount("#card-element");

  // Validate input of the card elements
  var resultContainer = document.getElementById('paymentResponse');
  cardElement.addEventListener('change', function(event) {
    if (event.error) {
        resultContainer.innerHTML = '<p style="color:#F00;">'+event.error.message+'</p>';
    } else {
        resultContainer.innerHTML = '';
    }
  });
  */
 // Old code for the card field
  var form = document.getElementById('paymentform');
  
  form.addEventListener('submit', function(e) {
    e.preventDefault(); // Always prevent default first
    // Passed all checks
    $("#payment_button").prop('disabled', true).text('Processing...').addClass('spinner');

    // Call token creation or further logic
    createToken();
  });

  // Create single-use token to charge the user


  function createToken() {
    var card_name = document.getElementById('card_name').value;

    // Use cardNumber element here, not cardElement
    stripe.createToken(cardNumber, { name: card_name }).then(function(result) {
      if (result.error) {
        // Inform the user if there was an error
        resultContainer.innerHTML = '<p style="color:#F00;">' + result.error.message + '</p>';
        $("#payment_button").prop('disabled', false);
        $("#payment_button").text('Confirm Purchase');
        $("#payment_button").removeClass('spinner');
      } else {
        // Send the token to your server
        stripeTokenHandler(result.token);
      }
    });
  }


  // Old code for the card field
  /*
  function createToken() {
    var card_name = document.getElementById('card_name').value;
      stripe.createToken(cardElement,{name: card_name}).then(function(result) {
        if (result.error) {
            // Inform the user if there was an error
            resultContainer.innerHTML = '<p style="color:#F00;">'+result.error.message+'</p>';
            $("#payment_button").prop('disabled', false);
            $("#payment_button").text('Confirm Purchase');
            $("#payment_button").removeClass('spinner');
        } else {
            // Send the token to your server
            stripeTokenHandler(result.token);
        }
    });
  }
  */
  // Old code for the card field

  // Callback to handle the response from stripe
  function stripeTokenHandler(token) {
    // Insert the token ID into the form so it gets submitted to the server
    var hiddenInput = document.createElement('input');
    hiddenInput.setAttribute('type', 'hidden');
    hiddenInput.setAttribute('name', 'stripeToken');
    hiddenInput.setAttribute('value', token.id);
    form.appendChild(hiddenInput);
    // Submit the form
    form.submit();
}
</script> 



%%DEFINE_FOOTER%%